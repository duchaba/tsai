---

title: tsai


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://github.com/timeseriesai/tsai/workflows/CI/badge.svg" alt="CI"> <a href="https://pypi.org/project/tsai/#description"><img src="https://img.shields.io/pypi/v/tsai?color=blue&amp;label=pypi%20version" alt="PyPI"></a> <a href="https://zenodo.org/badge/latestdoi/211822289"><img src="https://zenodo.org/badge/211822289.svg" alt="DOI"></a> <img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg" alt="PRs"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Description">Description<a class="anchor-link" href="#Description"> </a></h2><blockquote><p>State-of-the-art Deep Learning library for Time Series and Sequences.</p>
</blockquote>
<p><code>tsai</code> is an open-source deep learning package built on top of Pytorch &amp; fastai focused on state-of-the-art techniques for time series tasks like classification, regression, forecasting, imputation...</p>
<p><code>tsai</code> is currently under active development by timeseriesAI.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What's-new:">What's new:<a class="anchor-link" href="#What's-new:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="March-2022">March 2022<a class="anchor-link" href="#March-2022"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>⚡️ Starting with <strong>tsai 0.3.0</strong> you'll get <strong>faster installs and imports</strong> through a better use of dependencies.</li>
<li>New visualization methods: learn.feature_importance() and learn.step_importance() will help you gain better insights on how your models works.</li>
<li>New calibration model: learn.calibrate_model() for time series classification tasks.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="November,-2021">November, 2021<a class="anchor-link" href="#November,-2021"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>✅ Implemented some of the learnings from reviewing Kaggle's latest time series competition (see Medium <a href="https://towardsdatascience.com/key-takeaways-from-kaggles-most-recent-time-series-competition-ventilator-pressure-prediction-7a1d2e4e0131?source=user_profile---------0-------------------------------">blog post</a> for more details) like:<ul>
<li>improved RNN initialization (based on a kernel shared by <a href="https://www.kaggle.com/junkoda">https://www.kaggle.com/junkoda</a>)</li>
<li>added the option to pass a feature extractor to RNNPlus &amp; TSiT (Transformer) models.  </li>
<li>created a MultiConv layer that allows the concatenation of original features with the output of one or multiple convolution layers in parallel.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="September,-2021">September, 2021<a class="anchor-link" href="#September,-2021"> </a></h4><ul>
<li>See our new tutorial notebook on how to <strong>track your experiments with Weights &amp; Biases</strong>
<a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/12_Experiment_tracking_with_W%26B.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></li>
<li><code>tsai</code> just got easier to use with the new sklearn-like APIs: <a href="/tslearner.html#TSClassifier"><code>TSClassifier</code></a>, <a href="/tslearner.html#TSRegressor"><code>TSRegressor</code></a>, and <a href="/tslearner.html#TSForecaster"><code>TSForecaster</code></a>!! See <a href="https://timeseriesai.github.io/tsai/tslearner.html">this</a> for more info.</li>
<li><p>New tutorial notebook on how to <strong>train your model with larger-than-memory datasets in less time achieving up to 100% GPU usage!!</strong>   <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/11_How_to_train_big_arrays_faster_with_tsai.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
</li>
<li><p><strong><code>tsai</code> supports now more input formats</strong>: np.array, np.memmap, zarr, xarray, dask, list, L, ...</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Previously">Previously<a class="anchor-link" href="#Previously"> </a></h4><ul>
<li><p><strong>MINIROCKET</strong> a SOTA Time Series Classification model (now available in Pytorch):
You can now check MiniRocket's performance in our new tutorial notebook <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/10_Time_Series_Classification_and_Regression_with_MiniRocket.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<blockquote><p>"Using this method, it is possible to train and test a classifier on all of 109 datasets from the UCR archive to state-of-the-art accuracy in less than 10 minutes." A. Dempster et al. (Dec 2020)</p>
</blockquote>
</li>
<li><p><strong>Multi-class and multi-label time series classification notebook:</strong> you can also check our new tutorial notebook: <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/01a_MultiClass_MultiLabel_TSClassification.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
</li>
<li><p><strong>Self-supervised learning:</strong> Learn how to leverage your unlabeled datasets <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/08_Self_Supervised_TSBERT.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
</li>
<li><p><strong>New visualization:</strong>
We've also added a new PredictionDynamics callback that will display the predictions during training. This is the type of output you would get in a classification task for example:</p>
<p align="center">
  <img src="https://github.com/timeseriesAI/tsai/blob/main/nbs/multimedia/LSST_PD.gif?raw=true">
</p></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can install the <strong>latest stable</strong> version from pip using:</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tsai</span>
</pre></div>
<p>Or you can install the <strong>cutting edge</strong> version of this library from github by doing:</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">Uqq</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">timeseriesAI</span><span class="o">/</span><span class="n">tsai</span><span class="o">.</span><span class="n">git</span>
</pre></div>
<p>Once the install is complete just run:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
<p>Note: starting with tsai 0.3.0 tsai will only install hard dependencies. Other soft dependencies (which are only required for selected tasks) will not be installed by default (this is the recommended approach. If you require any of the dependencies that is not installed, tsai will ask you to install it when necessary). If you still want to install tsai with all its dependencies you can do it by running:</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tsai</span><span class="p">[</span><span class="n">extras</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Documentation">Documentation<a class="anchor-link" href="#Documentation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's the link to the <a href="https://timeseriesai.github.io/tsai/">documentation</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Available-models:">Available models:<a class="anchor-link" href="#Available-models:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a list with some of the state-of-the-art models available in <code>tsai</code>:</p>
<ul>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/RNN.py">LSTM</a> (Hochreiter, 1997) (<a href="https://ieeexplore.ieee.org/abstract/document/6795963/">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/RNN.py">GRU</a> (Cho, 2014) (<a href="https://arxiv.org/abs/1412.3555">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/MLP.py">MLP</a> - Multilayer Perceptron (Wang, 2016) (<a href="https://arxiv.org/abs/1611.06455">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/FCN.py">FCN</a> - Fully Convolutional Network (Wang, 2016) (<a href="https://arxiv.org/abs/1611.06455">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/ResNet.py">ResNet</a> - Residual Network (Wang, 2016) (<a href="https://arxiv.org/abs/1611.06455">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/RNN_FCN.py">LSTM-FCN</a> (Karim, 2017) (<a href="https://arxiv.org/abs/1709.05206">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/RNN_FCN.py">GRU-FCN</a> (Elsayed, 2018) (<a href="https://arxiv.org/abs/1812.07683">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/mWDN.py">mWDN</a> - Multilevel wavelet decomposition network (Wang, 2018) (<a href="https://dl.acm.org/doi/abs/10.1145/3219819.3220060">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/TCN.py">TCN</a> - Temporal Convolutional Network (Bai, 2018) (<a href="https://arxiv.org/abs/1803.01271">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/RNN_FCN.py">MLSTM-FCN</a> - Multivariate LSTM-FCN (Karim, 2019) (<a href="https://www.sciencedirect.com/science/article/abs/pii/S0893608019301200">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/InceptionTime.py">InceptionTime</a> (Fawaz, 2019) (<a href="https://arxiv.org/abs/1909.04939">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/ROCKET.py">Rocket</a> (Dempster, 2019) (<a href="https://arxiv.org/abs/1910.13051">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/XceptionTime.py">XceptionTime</a> (Rahimian, 2019) (<a href="https://arxiv.org/abs/1911.03803">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/ResCNN.py">ResCNN</a> - 1D-ResCNN (Zou , 2019) (<a href="https://www.sciencedirect.com/science/article/pii/S0925231219311506">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/TabModel.py">TabModel</a> - modified from fastai's <a href="https://docs.fast.ai/tabular.model.html#TabularModel">TabularModel</a></li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/OmniScaleCNN.py">OmniScale</a> - Omni-Scale 1D-CNN (Tang, 2020) (<a href="https://arxiv.org/abs/2002.10061">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/TST.py">TST</a> - Time Series Transformer (Zerveas, 2020) (<a href="https://dl.acm.org/doi/abs/10.1145/3447548.3467401">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/TabTransformer.py">TabTransformer</a> (Huang, 2020) (<a href="https://arxiv.org/pdf/2012.06678">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/MINIROCKET.py">MiniRocket</a> (Dempster, 2021) (<a href="https://arxiv.org/abs/2102.00457">paper</a>)</li>
<li><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/models/XCM.py">XCM</a> - An Explainable Convolutional Neural Network (Fauvel, 2021) (<a href="https://hal.inria.fr/hal-03469487/document">paper</a>)</li>
</ul>
<p>among others!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-start-using-tsai?">How to start using tsai?<a class="anchor-link" href="#How-to-start-using-tsai?"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get to know the tsai package, we'd suggest you start with this notebook in Google Colab: <strong><a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/01_Intro_to_Time_Series_Classification.ipynb">01_Intro_to_Time_Series_Classification</a></strong>
It provides an overview of a time series classification task.</p>
<p>We have also develop many other <a href="https://github.com/timeseriesAI/tsai/tree/main/tutorial_nbs">tutorial notebooks</a>.</p>
<p>To use tsai in your own notebooks, the only thing you need to do after you have installed the package is to run this:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are just a few examples of how you can use <code>tsai</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Binary,-univariate-classification">Binary, univariate classification<a class="anchor-link" href="#Binary,-univariate-classification"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Training:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_classification_data</span><span class="p">(</span><span class="s1">&#39;ECG200&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">TSStandardize</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">TSClassifier</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">InceptionTimePlus</span><span class="p">,</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">ShowGraph</span><span class="p">())</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">3e-4</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;clf.pkl&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Inference:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.inference</span> <span class="kn">import</span> <span class="n">load_learner</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="s2">&quot;models/clf.pkl&quot;</span><span class="p">)</span>
<span class="n">probas</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">get_X_preds</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-class,-multivariate-classification">Multi-class, multivariate classification<a class="anchor-link" href="#Multi-class,-multivariate-classification"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Training:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_classification_data</span><span class="p">(</span><span class="s1">&#39;LSST&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">TSStandardize</span><span class="p">(</span><span class="n">by_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mv_clf</span> <span class="o">=</span> <span class="n">TSClassifier</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">InceptionTimePlus</span><span class="p">,</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">ShowGraph</span><span class="p">())</span>
<span class="n">mv_clf</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
<span class="n">mv_clf</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;mv_clf.pkl&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Inference:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.inference</span> <span class="kn">import</span> <span class="n">load_learner</span>
<span class="n">mv_clf</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="s2">&quot;models/mv_clf.pkl&quot;</span><span class="p">)</span>
<span class="n">probas</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">mv_clf</span><span class="o">.</span><span class="n">get_X_preds</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multivariate-Regression">Multivariate Regression<a class="anchor-link" href="#Multivariate-Regression"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Training:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_regression_data</span><span class="p">(</span><span class="s1">&#39;AppliancesEnergy&#39;</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">TSStandardize</span><span class="p">(</span><span class="n">by_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">TSRegressor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">TSTPlus</span><span class="p">,</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">rmse</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">ShowGraph</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">3e-4</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;reg.pkl&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Inference:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.inference</span> <span class="kn">import</span> <span class="n">load_learner</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="s2">&quot;models/reg.pkl&quot;</span><span class="p">)</span>
<span class="n">raw_preds</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">get_X_preds</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The ROCKETs (RocketClassifier, RocketRegressor, MiniRocketClassifier, MiniRocketRegressor, MiniRocketVotingClassifier or MiniRocketVotingRegressor) are somewhat different models. They are not actually deep learning models (although they use convolutions) and are used in a different way.</p>
<p>⚠️ You'll also need to install sktime to be able to use them. You can install it separately or use:</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tsai</span><span class="p">[</span><span class="n">extras</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Training:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_regression_data</span><span class="p">(</span><span class="s1">&#39;AppliancesEnergy&#39;</span><span class="p">)</span>
<span class="n">rmse_scorer</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mr_reg</span> <span class="o">=</span> <span class="n">MiniRocketRegressor</span><span class="p">(</span><span class="n">scoring</span><span class="o">=</span><span class="n">rmse_scorer</span><span class="p">)</span>
<span class="n">mr_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">mr_reg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;minirocket_regressor&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Inference:</strong></p>
<div class="highlight"><pre><span></span><span class="n">mr_reg</span> <span class="o">=</span> <span class="n">load_rocket</span><span class="p">(</span><span class="s2">&quot;minirocket_regressor&quot;</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">mr_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Forecasting">Forecasting<a class="anchor-link" href="#Forecasting"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use tsai for forecast in the following scenarios:</p>
<ul>
<li>univariate or multivariate time series input</li>
<li>univariate or multivariate time series output</li>
<li>single or multi-step ahead</li>
</ul>
<p>You'll need to:</p>
<ul>
<li>prepare X (time series input) and the target y (see <a href="https://timeseriesai.github.io/tsai/data.preparation.html">documentation</a>)</li>
<li>select one of tsai's models ending in Plus (TSTPlus, InceptionTimePlus, TSiTPlus, etc). The model will auto-configure a head to yield an output with the same shape as the target input y. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Single-step">Single step<a class="anchor-link" href="#Single-step"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Training:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">get_forecasting_time_series</span><span class="p">(</span><span class="s2">&quot;Sunspots&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TimeSplitter</span><span class="p">(</span><span class="mi">235</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span> 
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">TSStandardize</span><span class="p">()</span>
<span class="n">fcst</span> <span class="o">=</span> <span class="n">TSForecaster</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">TSTPlus</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">ShowGraph</span><span class="p">())</span>
<span class="n">fcst</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
<span class="n">fcst</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;fcst.pkl&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Inference:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.inference</span> <span class="kn">import</span> <span class="n">load_learner</span>
<span class="n">fcst</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="s2">&quot;models/fcst.pkl&quot;</span><span class="p">,</span> <span class="n">cpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">raw_preds</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">fcst</span><span class="o">.</span><span class="n">get_X_preds</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">raw_preds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
<p>output: torch.Size([2940, 1])</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Multi-step">Multi-step<a class="anchor-link" href="#Multi-step"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This example show how to build a 3-step ahead univariate forecast.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Training:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">get_forecasting_time_series</span><span class="p">(</span><span class="s2">&quot;Sunspots&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TimeSplitter</span><span class="p">(</span><span class="mi">235</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span> 
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">TSStandardize</span><span class="p">()</span>
<span class="n">fcst</span> <span class="o">=</span> <span class="n">TSForecaster</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">TSTPlus</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">ShowGraph</span><span class="p">())</span>
<span class="n">fcst</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
<span class="n">fcst</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;fcst.pkl&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Inference:</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.inference</span> <span class="kn">import</span> <span class="n">load_learner</span>
<span class="n">fcst</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="s2">&quot;models/fcst.pkl&quot;</span><span class="p">,</span> <span class="n">cpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">raw_preds</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">fcst</span><span class="o">.</span><span class="n">get_X_preds</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">raw_preds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
<p>output: torch.Size([2938, 3])</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-data-format">Input data format<a class="anchor-link" href="#Input-data-format"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The input format for all time series models and image models in tsai is the same. An np.ndarray (or array-like object like zarr, etc) with 3 dimensions:</p>
<p><strong>[# samples x # variables x sequence length]</strong></p>
<p>The input format for tabular models in tsai (like TabModel, TabTransformer and TabFusionTransformer) is a pandas dataframe. See <a href="https://timeseriesai.github.io/tsai/models.TabModel.html">example</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-contribute-to-tsai?">How to contribute to tsai?<a class="anchor-link" href="#How-to-contribute-to-tsai?"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We welcome contributions of all kinds. Development of enhancements, bug fixes, documentation, tutorial notebooks, ...</p>
<p>We have created a guide to help you start contributing to tsai. You can read it <a href="https://github.com/timeseriesAI/tsai/blob/main/CONTRIBUTING.md">here</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Citing-tsai">Citing tsai<a class="anchor-link" href="#Citing-tsai"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you use tsai in your research please use the following BibTeX entry:</p>
<div class="highlight"><pre><span></span>@Misc{tsai,
    author =       {Ignacio Oguiza},
    title =        {tsai - A state-of-the-art deep learning library for time series and sequential data},
    howpublished = {Github},
    year =         {2022},
    url =          {https://github.com/timeseriesAI/tsai}
}
</pre></div>

</div>
</div>
</div>
</div>
 

